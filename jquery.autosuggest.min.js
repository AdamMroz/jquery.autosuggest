/*jQuery.autoSuggest v0.1
Created by Bartosz Krawczyk
http://bkwebdesign.pl/
MIT License*/
jQuery.fn.highlight=function(c){var e=new RegExp(c,"gi");return this.each(function(){$(this).contents().filter(function(){return 3==this.nodeType&&e.test(this.nodeValue)}).replaceWith(function(){return(this.nodeValue||"").replace(e,function(a){return"<b>"+a+"</b>"})})})};
$.fn.autosuggest=function(c){var e=$.extend({server:"asg_server.php",delay:600,start:2},c),a=$(this);$(this).attr("id");c=$(this).width();var g=e.start-1;a.wrap('<div class="cp-asuggest-wrap"></div>');a.closest(".cp-asuggest-wrap").append('<div class="cp-asuggest-list-box"></div>');a.next(".cp-asuggest-list-box").css({"min-width":c});a.on("keyup",function(){a.attr("data-id","0");$(".cp-asuggest-list-box").empty();var b=0,c=0;if(a.val().trim().length>=g){timer=0;var h=function(){b=0;var d=a.val().trim();
a.val().trim().length>g?a.next(".cp-asuggest-list-box").load(e.server,{query:d},function(){c=a.closest(".cp-asuggest-wrap").find(".cp-asuggest-list").length;a.closest(".cp-asuggest-wrap").find(".cp-asuggest-list").highlight(d)}):a.next(".cp-asuggest-list-box").empty()};a.off("keyup").on("keyup",function(d){a.attr("data-id","0");if(38!=d.which&&40!=d.which&&13!=d.which)timer&&clearTimeout(timer),timer=setTimeout(h,e.delay);else{40==d.which&&(b==c?b=c:b++,a.closest(".cp-asuggest-wrap").find(".cp-asuggest-list").removeClass("cp-asg-selected"),
a.closest(".cp-asuggest-wrap").find(".cp-asg-onlist-"+b).addClass("cp-asg-selected"));if(38==d.which){0<b&&(1==b?b=1:b--,a.closest(".cp-asuggest-wrap").find(".cp-asuggest-list").removeClass("cp-asg-selected"),a.closest(".cp-asuggest-wrap").find(".cp-asg-onlist-"+b).addClass("cp-asg-selected"));var f=a.val();a.val("");a.val(f)}13==d.which&&0<b&&(d=a.closest(".cp-asuggest-wrap").find(".cp-asg-onlist-"+b).text(),f=a.closest(".cp-asuggest-wrap").find(".cp-asg-onlist-"+b).attr("data-id"),a.next(".cp-asuggest-list-box").empty(),
a.val(d).attr("data-id",f))}})}});$(document).off("click",".cp-asuggest-list").on("click",".cp-asuggest-list",function(a){var c=$(this).text(),e=$(this).attr("data-id");"0"!=e&&($(this).closest(".cp-asuggest-wrap").find("input").val(c).attr("data-id",e),$(this).closest(".cp-asuggest-list-box").empty());a.preventDefault();return!1});$(document).on("click","html",function(a){$(".cp-asuggest-list-box").empty()})};
